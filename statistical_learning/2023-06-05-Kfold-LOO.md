---
excerpt: "Leave-one-outκ³Ό K-foldμ— λ€ν•΄ μ•μ•„λ³΄μ."

categories :
  - Statistical learning
tags :
  - [ν†µκ³„ ν•™μµ]

toc: true
toc_sticky: true

date: 2023-05-30
last_modified_at: 2023-07-02

title: "Leave-one-out κµμ°¨ κ²€μ¦κ³Ό K-fold κµμ°¨ κ²€μ¦"
---
μ¤λμ€ κµμ°¨κ²€μ¦μ„ μ£Όμ¬λ΅ ν¬μ¤ν…μ„ ν•λ ¤κ³  ν•©λ‹λ‹¤.

ν”ν κΈ°κ³„ ν•™μµμ„ ν•  λ• μ°λ¦¬λ” νƒ€λ‹Ήλ„λ¥Ό μ„ν•΄ κµμ°¨κ²€μ¦μ„ ν•©λ‹λ‹¤. κµμ°¨κ²€μ¦μ„ μ΄ν•΄ν•κΈ° μ„ν•΄ λ¨Όμ € training set : ν›λ ¨ μ„ΈνΈμ™€ test set : μ‹ν— μ„ΈνΈλ¥Ό μ΄μ•ΌκΈ° ν•΄λ΄…μ‹λ‹¤.

<br>

# Train set, Test set

---

**ν›λ ¨ μ„ΈνΈμ™€ μ‹ν— μ„ΈνΈ**

μ°λ¦¬κ°€ νΉμ • λ³€μλ¥Ό λ¶„λ¥ν•κΈ° μ„ν• λ¨λΈμ„ κ°λ°ν–λ‹¤κ³  ν•©λ‹λ‹¤. μ΄ λ¨λΈμ΄ μ–Όλ§λ‚ μΌλ°μ μΌλ΅ μ‘λ™ν•λ”μ§€ μ„±λ¥μ„ ν‰κ°€ν•΄μ•Ό ν•©λ‹λ‹¤. μ¦‰, **μ°λ¦¬κ°€ λ¨λΈμ„ λ§λ“λ”λ° μ‚¬μ©ν• λ°μ΄ν„° λΏ μ•„λ‹ λ‹¤λ¥Έ μƒλ΅μ΄ λ°μ΄ν„°μ— λ€ν•΄μ„λ„ μ μ‘λ™ν•κ³  μ λ¶„λ¥ν•λ”μ§€ μ•μ•„μ•Ό ν•©λ‹λ‹¤.**
**μ΄λ¥Ό μ„ν•΄ μ°λ¦¬λ” λ°μ΄ν„° μ„ΈνΈλ¥Ό ν›λ ¨ μ„ΈνΈμ™€ μ‹ν— μ„ΈνΈλ΅ λ‚λ•λ‹λ‹¤.Β **

λ°μ΄ν„° μ„ΈνΈλ¥Ό μ„μλ΅ λ‘κ° μ„ΈνΈλ΅ μ¦‰, ν›λ ¨ μ„ΈνΈμ™€ μ‹ν— μ„ΈνΈλ΅ λ‚λ„μ–΄ μ„±λ¥μ„ ν‰κ°€ν•©λ‹λ‹¤. ν›λ ¨ μ„ΈνΈλ΅ λ¨λΈμ„ ν›λ ¨μ‹ν‚¤κ³ , ν…μ¤νΈ μ„ΈνΈλ΅λ” μ„±λ¥μ„ ν‰κ°€ν•©λ‹λ‹¤. μ¦‰, *μ΄λ―Έ ν›λ ¨ν–λ μ„ΈνΈλ΅ ν›λ ¨ν•μ§€ μ•κ³  ν›λ ¨μ— μ‚¬μ©ν•μ§€ μ•μ€ μ‹ν— μ„ΈνΈλ¥Ό μ΄μ©ν•μ—¬ λ§μΉ κΈ°μ΅΄μ— μ—†λ, μƒλ΅ μƒκΈ΄ λ°μ΄ν„°λ¥Ό μ μ©μ‹ν‚¤λ” λ°©μ‹μΌλ΅ λ³΄λ©΄ λ  κ²ƒ κ°™μµλ‹λ‹¤.*

![image](https://github.com/novicedata/colab_practice/assets/88019539/2d2d4752-dcf6-469e-94dd-63994e52db0f){: .align-center}


<br>

# κµμ°¨ κ²€μ¦(Cross Validation)
---

μ΄λ ‡κ² μ‰¬μ°λ©΄ μΆ‹κ² μ§€λ§? **μ‹¤μ λ΅λ” λ¬Έμ κ°€ μμµλ‹λ‹¤. μ°μ„  λ°μ΄ν„° μ„ΈνΈκ°€ λ„λ¬΄ μ‘μ„ κ²½μ° μ΄λ¬ν• λ°©λ²•μ€ λ‘ κ°μ μ„ΈνΈλ¥Ό μ–΄λ–»κ² μ–΄λμ •λ„λ΅ λ‚λ„λλƒμ— λ”°λΌμ„ κ²°κ³Όκ°€ λ§¤μ° λ‹¤λ¥Ό μ μμµλ‹λ‹¤.Β **

μλ¥Ό λ“¤μ–΄ ν›λ ¨ μ„ΈνΈμ—λ” λ¶„λ¥ν•κΈ° μ‰¬μ΄ μƒν”λ“¤μ΄, μ‹ν— μ„ΈνΈμ—λ” μ–΄λ ¤μ΄ μƒν”λ“¤μ΄ λ“¤μ–΄κ°„λ‹¤λ©΄? ν›λ ¨μ‹ν‚¨ λ¨λΈμ„ μ‹ν— μ„ΈνΈμ— μ μ©ν•λ‹¤λ©΄ μ‰½κ² λ¶„λ¥ν•΄λ‚΄μ§€ λ»ν•κ² μ£ .
μ΄λ¬ν• λ¬Έμ λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄ κµμ°¨ κ²€μ¦μ„ μ‚¬μ©ν•©λ‹λ‹¤. λ°μ΄ν„° μ„ΈνΈλ¥Ό λ‹¨ ν• λ²λ§ λ‚λ„μ–΄ ν›λ ¨μ‹ν‚¤κ³  ν…μ¤νΈν•λ” κ²ƒμ΄ μ•„λ‹λΌ, μ΄λ¥Ό λ°λ³µν•μ—¬ μ„±λ¥μ„ ν‰κ· ν™”ν•λ” κ²ƒμ…λ‹λ‹¤. μ΄λ ‡κ² μ§„ν–‰ ν•λ‹¤λ©΄ λ‹¨ ν•λ²μ μ°μ—°μ— μν• κ²°κ³Ό λ¶„μ‚°λ³΄λ‹¤λ” λ”μ± μ‘μ•„μ§€κ² μ£ . κ·Έλ ‡λ‹¤λ©΄ *λ‘ κ°€μ§€ λ°©λ²•μΈ K-fold cross validationκ³Ό leave-one-out λ°©λ²•μ„ λ΄…μ‹λ‹¤.*

<br>

## π“ K-fold

**K-fold κµμ°¨ κ²€μ¦μ€ λ¨Όμ € λ°μ΄ν„° μ„ΈνΈλ¥Ό kκ°μ λ™μΌν• ν¬κΈ°λ΅ λ‚λ„μ–΄ ν•μ„ μ„ΈνΈλ¥Ό μƒμ„±ν•©λ‹λ‹¤.**

![image](https://github.com/novicedata/colab_practice/assets/88019539/e0a9612f-c5b2-4a82-9221-0235df2d6546){: .align-center}

κ·Έλ¦¬κ³  kλ² λ°λ³µν•μ—¬ κ°κ° kκ°μ ν•μ„ μ„ΈνΈμ¤‘μ— ν•λ‚μ μ„ΈνΈλ¥Ό ν…μ¤νΈ μ„ΈνΈλ΅ μ‚¬μ©ν•κ³  λ‚λ¨Έμ§€λ¥Ό ν›λ ¨ μ„ΈνΈλ΅ μ΄μ©ν•©λ‹λ‹¤.
κ·Έλ¦¬κ³  kλ² μ‹ν–‰ν• μ μλ¥Ό ν‰κ· ν™”ν•μ—¬ λ¨λΈ μ„±λ¥μ„ λ΄…λ‹λ‹¤. 
μλ¥Ό λ“¤μ–΄λ³΄μ£  μ°λ¦¬κ°€ κ°€μ§„ λ°μ΄ν„°κ°€ {a, b, c, d, e, f}κ°€ μλ‹¤κ³  ν•©λ‹λ‹¤. 3-fold κµμ°¨ κ²€μ¦μ„ ν•λ‹¤λ©΄

**set1 = {a, b}**

**set2 = {c, d}**

**set3 = {e, f}**

μ„μ™€ κ°™μ΄ 3κ°μ ν•μ„ μ„ΈνΈλ΅ λ‚λ•λ‹λ‹¤. (μ„ΈνΈκ°€ {a, f}λ“±λ“± λ  μλ„ μμµλ‹λ‹¤. λ³΄κΈ° νΈν•λ„λ΅ μ•νλ²³ μμ„λ΅ ν• κ²ƒμ…λ‹λ‹¤)

κ·Έλ¦¬κ³  μ΄ μ¤‘ **ν•λ‚μ μ„ΈνΈλ¥Ό μ‹ν— μ„ΈνΈλ΅ μ΄μ©ν•©λ‹λ‹¤. μ‹ν— μ„ΈνΈλ¥Ό λ°”κΏ”κ°€λ©° kλ²(μ—¬κΈ°μ„λ” 3) λ°λ³µν•λ” κ²ƒμ…λ‹λ‹¤.**

**μ‹ν–‰ 1 : ν›λ ¨ μ„ΈνΈ = set1, set2 / μ‹ν— μ„ΈνΈ = set3**

**μ‹ν–‰ 2 : ν›λ ¨ μ„ΈνΈ = set1, set3 / μ‹ν— μ„ΈνΈ = set2**

**μ‹ν–‰ 3 : ν›λ ¨ μ„ΈνΈ = set2, set3 / μ‹ν— μ„ΈνΈ = set1**

κ·Έ ν›„ 3λ²μ μ‹ν–‰μΌλ΅ μ–»μ€ 3κ°μ μ„±λ¥ μ μλ¥Ό ν‰κ· ν™” ν•λ” κ²ƒμ…λ‹λ‹¤.

<br>

## π“ Leave-one-out

**Leave-one-out κµμ°¨ κ²€μ¦μ—μ„λ” λ°μ΄ν„° μ„ΈνΈ ν¬κΈ°μΈ n. n λ§νΌ ν›λ ¨ν•©λ‹λ‹¤. μ΄λ¦„ μ²λΌ λ‹¨ ν•λ‚μ μƒν”λ§μ„ ν…μ¤νΈ μ„ΈνΈλ΅ μ‚¬μ©ν•κ³  λ‚λ¨Έμ§€λ¥Ό ν›λ ¨μ„ΈνΈλ΅ μ΄μ©ν•©λ‹λ‹¤.**

![image](https://github.com/novicedata/colab_practice/assets/88019539/14b39967-3d33-4c9e-9a72-89a6f11302d1){: .align-center}

μ„μ μμ‹λ¥Ό μ΄μ©ν•λ©΄

**set1 = {a} , set2 = {b}, set3 = {c} , set4 = {d}, set5 = {e} , set6 = {f}** λ΅ λ°μ΄ν„°λ¥Ό μ§‘ν•©μΌλ΅ λ‚λ ν›„,

**μ‹ν–‰ 1 : ν›λ ¨ μ„ΈνΈ = set1, set2, set3, set4, set5 / μ‹ν— μ„ΈνΈ = set6**

**μ‹ν–‰ 2 : ν›λ ¨ μ„ΈνΈ = set1, set2, set3, set4, set6 / μ‹ν— μ„ΈνΈ = set5**

**μ‹ν–‰ 3 : ν›λ ¨ μ„ΈνΈ = set1, set2, set3, set5, set6 / μ‹ν— μ„ΈνΈ = set4**

**μ‹ν–‰ 4 : ν›λ ¨ μ„ΈνΈ = set1, set2, set4, set5, set6 / μ‹ν— μ„ΈνΈ = set3**

**μ‹ν–‰ 5 : ν›λ ¨ μ„ΈνΈ = set1, set3, set4, set5, set6 / μ‹ν— μ„ΈνΈ = set2**

**μ‹ν–‰ 6 : ν›λ ¨ μ„ΈνΈ = set2, set3, set4, set5, set6 / μ‹ν— μ„ΈνΈ = set1**

κ·Έ ν›„ nλ²μ μ‹ν–‰μΌλ΅ μ–»μ€ nκ°μ μ„±λ¥ μ μλ¥Ό ν‰κ· ν™” ν•©λ‹λ‹¤.

<br>

# μ΄λ“¤μ μ°¨μ΄

---

κ·Έλ ‡λ‹¤λ©΄ μ €ν¬λ” λ¨λΈ μ„±λ¥μ„ ν‰κ°€ν•  λ• μ–΄λ–¤ λ°©λ²•μ„ μ‚¬μ©ν•΄μ•Ό ν• κΉμ”?
μ„ μμ‹λ¥Ό ν†µν•΄ λ³΄μ…¨λ‹¤λ©΄ μ μ¶”ν•μ‹¤ μ μκ² μ§€λ§, **λ³΄ν†µ leave-one-outμ΄ λ‹¨ ν•λ‚μ μ„ΈνΈλ¥Ό μ‹ν— μ„ΈνΈλ΅ μ΄μ©ν•κΈ° λ•λ¬Έμ— μ‹ν–‰μ΄ λ” λ§μµλ‹λ‹¤.**

**λ”°λΌμ„ λ§μ•½ λ°μ΄ν„° μ„ΈνΈμ ν¬κΈ°κ°€ μ‘λ‹¤λ©΄? leave-one-outμ΄ λ” μ ν•©ν•  μ μμµλ‹λ‹¤.**

**λ°λ€λ΅ λ°μ΄ν„° μ„ΈνΈκ°€ λ§λ‹¤λ©΄ leave-one-outμ λ°©λ²•μ„ λ¨λΈμ„ ν›λ ¨ν•λ” μ‹κ°„μ΄ λ„λ¬΄ μ¤λκ±Έλ¦΄ μ μμµλ‹λ‹¤. λν•, μ¶©λ¶„ν λ§μ€ λ°μ΄ν„°λΌλ©΄ κµ³μ΄ nκ°λ΅ μ„ΈνΈλ¥Ό λ‚λ„λ” κ²ƒλ³΄λ‹¤ μ μ€ μμΈ k(n < k)λ΅ λ‚λ„λ” κ²ƒλ„ μ¶©λ¶„ν• κ²°κ³Όλ¥Ό λ‚΄κΈ° λ•λ¬Έμ— k-foldκ°€ μΆ‹μ€ λ°©λ²•μΌ μ μμµλ‹λ‹¤.**
