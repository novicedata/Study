---
excerpt: "êµì°¨ê²€ì¦ì„ ì•Œì•„ë³´ì"

categories:
  - Resampling

tags:
  - [í†µê³„ ë¶„ì„]

toc: true
toc_sticky: true

breadcrumb: true

date: 2023-09-16
last_modified_at: 2023-09-16

title: "êµì°¨ ê²€ì¦ : Hold-out, Leave-one-out, K-fold"
---
<br>

**`ì•„ë˜ì—ì„œ ì„¤ëª…í•˜ëŠ” ë‚´ìš©ì€ ëª¨ë‘ Train setë¥¼ ì´ë¯¸ ë”°ë¡œ ë‘” ìƒíƒœë¥¼ ê°€ì •í•˜ê³  ì„¤ëª…í•˜ëŠ” ê²ë‹ˆë‹¤.`**

<br>

# ğŸ“Œ Hold-out
---

**`Hold-out`**ë°©ë²•ì˜ ê²½ìš° ê°„ë‹¨í•©ë‹ˆë‹¤. ë³´í†µ 50:50ì„ ì‚¬ìš©í•˜ê³  ì£¼ì–´ì§„ ë°ì´í„°ë¥¼ ëœë¤í•˜ê²Œ Train set, Validation setë¡œ ë‚˜ëˆ•ë‹ˆë‹¤.

![image](https://github.com/novicedata/colab_practice/assets/88019539/9acae7c7-e562-44d1-8ade-37591911a7b9){: .align-center}

## `with R`

```r
# Auto dataì˜ mpg ì‚¬ìš©.


library(ISLR)
set.seed(42)

data = Auto$mpg
dim(data.frame(data))
>> 392 1 
```

```r
# caretì´ìš©
library(caret)
train = createDataPartition(data, p=0.5)
dim(data.frame(train))
>> 198 1
```

**`10ë²ˆ í•´ë³´ê¸°`**

```r
for (i in 1:10) {
  set.seed(i) # ì‹œë“œ ë³€ê²½í•˜ë©° ë³´ê¸°
  train = createDataPartition(data,p=0.5, list=FALSE)
  MSE = rep(0:10) # error ì €ì¥í•  ì˜ë²¡í„° ê¸¸ì´ 0
  
  for (j in 1:10) {
    fit = lm(mpg ~ poly(horsepower, j), data=Auto,
             subset = train)
    MSE[j] = mean((Auto$mpg[-train]-predict(fit, Auto[-train,]))^2)
  }
  if (i == 1) {
    plot(MSE, ylab='MSE', xlab='ë‹¤í•­íšŒê·€ ì°¨ìˆ˜')
    
  } else {
    lines(MSE, col=i)
  }
}
```

![image](https://github.com/novicedata/colab_practice/assets/88019539/823ac975-1469-4fb3-9c90-4a066f211b8f){: .align-center}

ë‹¤í•­ í•¨ìˆ˜ë¡œ í•´ë³¸ ì˜ˆì‹œ ì…ë‹ˆë‹¤. 2ì°¨í•­ë¶€í„° ëŒ€ëµ 9ì°¨í•­ê¹Œì§€ MSEì˜ ì°¨ì´ê°€ ì—†ëŠ” ê±¸ ë³´ë‹ˆ validaition setë¡œ ë³¸ ê²°ê³¼ 2ì°¨í•­ê¹Œì§€ë§Œ ì‚¬ìš©í•´ì„œ test setìœ¼ë¡œ ì„±ëŠ¥ì„ í™•ì¸í•˜ë©´ ë  ê²ƒê°™ë„¤ìš”.

<br>

# ğŸ“Œ Leave-One-Out Cross-validation
---

**`LOOCV`**. ì´í•´í•˜ê¸° êµ‰ì¥íˆ ì‰½ìŠµë‹ˆë‹¤. ë°ì´í„°ê°€ nê°œ ìˆë‹¤ê³  í•  ë•Œ. n-1ê°œë¥¼ ëœë¤ìœ¼ë¡œ ë½‘ì•„ train setë¥¼ ë§Œë“¤ê³  ë‚˜ë¨¸ì§€ 1ê°œë¥¼ validation setë¡œ ì´ìš©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ë‹¨ì ì´ë¼ë©´ ë°ì´í„°ê°€ ì»¤ì§ˆìˆ˜ë¡ Train, Test setë¡œ splití•œ setê°€ ë§ì•„ì§„ë‹¤ëŠ” ê±°ì£ . ê·¸ë§Œí¼ ì»´í“¨íŒ… ìì›ì´ ë§ì´ ë“­ë‹ˆë‹¤.

![image](https://github.com/novicedata/colab_practice/assets/88019539/850e0187-2bfc-4fb0-aa73-e7e5eb12c075){: .align-center}

**`error ê³„ì‚°`**

$$
MSE_i = (y_i-\hat{y}_i)^2
$$

ì¼ë•Œ leave one out cvë¥¼ ì‚¬ìš©í•œ test errorëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

$$
LOO_{e(n)} = \frac1n \sum^n_{i=1}MSE_i
$$

## `with R`

ë˜‘ê°™ì´ mpgë¥¼ ì´ìš©í•©ë‹ˆë‹¤.

```r
library(boot)

MSE = rep(0,10) 
for (i in 1:10) {
  fit = glm(mpg~poly(horsepower, i), data=Auto)
  MSE[i]= cv.glm(Auto, fit)$delta[1] # LOOCV ìˆ˜í–‰ í›„ MSE ì¶”ì¶œ
  
  plot(MSE, type='o', xlab='ì°¨ìˆ˜', col='blue')
}
```

![image](https://github.com/novicedata/colab_practice/assets/88019539/c9d0aef5-c4be-4480-a5a5-f899617660a7){: .align-center}

<br>

# ğŸ“Œ k-fold Cross-validation
---

**`k-fold`**ì…ë‹ˆë‹¤. ìœ„ì—ì„œ LOOCVì˜ ê²½ìš° ë°ì´í„°ê°€ í¬ë©´ í´ìˆ˜ë¡ ì»´í“¨íŒ… ìì›ì´ ë§ì´ ë“ ë‹¤ëŠ” ë‹¨ì ì´ ìˆì—ˆì£ (ì‹¤ì œë¡œ ë°ì´í„°ë¥¼ ë‹¤ë£¨ë‹¤ë³´ë©´ ì˜ëª»ì”ë‹ˆë‹¤..) ê·¸ë˜ì„œ **nê°œì˜ ë°ì´í„°ì—ì„œ n-1ê°œë¡œ train setë¥¼ ë§Œë“œëŠ”ê²Œ ì•„ë‹ˆë¼ ì›í•˜ëŠ” ê°œìˆ˜ì˜ foldë¡œ ë§Œë“¤ì–´ ë‚˜ëˆ•ë‹ˆë‹¤.**

ì•„ë˜ ê·¸ë¦¼ì€ **4-fold ì˜ˆì‹œì…ë‹ˆë‹¤.**

![image](https://github.com/novicedata/colab_practice/assets/88019539/beee783d-f6b7-482c-aec0-c589b9a55ad0){: .align-center}

**`error ê³„ì‚°`**

$$
Fold_{e(k)} = \frac1k \sum^k_{i=1}MSE_i
$$

## `with R`

```r
set.seed(15)
k =10
MSE_matrix = matrix(0, nrow=k, ncol=10)
folds <- sample(1:k, length(Auto$mpg), replace = T, prob=rep(1/k,k))

for (i in 1:k) {
  for (j in 1:10) {
    fit = lm(mpg~poly(horsepower,j), data = Auto[folds != i, ])
    pred = predict(fit, newdata=Auto[folds == i,])
    MSE_matrix[i,j] = mean((pred-Auto$mpg[folds == i])^2)
  }
  if (i == 1) {
    plot(MSE, type = 'l', xlab='ì°¨ìˆ˜', ylab='MSE')
  } else {
    lines(MSE_matrix[i,], type = 'l', col=i)
  }
}
```

![image](https://github.com/novicedata/colab_practice/assets/88019539/a08c2a61-ac32-4f98-871b-0fba4cd2922b){: .align-center}

ê·¸ë˜í”„ë¥¼ ë³´ì‹œë©´ ë§¨ì²˜ìŒ Hold-outê³¼ ë¹„ìŠ·í•˜ê²Œ 2ì°¨ì—ì„œ ë¹„ìŠ·í•´ì§€ëŠ” ê²½í–¥ì´ ìˆìŠµë‹ˆë‹¤. ì½”ë“œë¥¼ ëŒë ¤ë³´ì‹œë©´ ì•„ì‹œê² ì§€ë§Œ ì´ê²Œ seedê°’ì„ ë³€ê²½í•´ì¤„ ë•Œë§ˆë‹¤ MSE ê°’ ì°¨ì´ê°€ ì¢€ ìˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ì •í™•íˆ ë³´ë ¤ë©´ ì‹œê°„ì´ ê±¸ë¦¬ë”ë¼ë„ LOOCVê°€ ì¢‹ì„ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
