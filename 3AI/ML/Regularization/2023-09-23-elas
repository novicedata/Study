---
excerpt: "ì—˜ë¼ìŠ¤í‹± ë„·ì— ëŒ€í•´ ì•Œì•„ë³´ì."

categories:
  - Regularization

tags:
  - [í†µê³„ ë¶„ì„]

toc: true
toc_sticky: true

breadcrumb: true

date: 2023-09-23
last_modified_at: 2023-09-23

title: "ì •ê·œí™” : ì—˜ë¼ìŠ¤í‹± ë„·(Elastic nets) with R"
---

<br>

# ğŸ“Œ Elastic Nets(ì—˜ë¼ìŠ¤í‹± ë„·)

---

ë¨¼ì € ì—˜ë¼ìŠ¤í‹± ë„·ì— ëŒ€í•´ ì´í•´í•˜ê¸° ìœ„í•´ ì•„ë˜ ë‚´ìš©ì„ ì°¸ì¡°í•´ì£¼ì‹œê¸¸ ë°”ëë‹ˆë‹¤. ì´ì–´ì§€ëŠ” ë‚´ìš©ì…ë‹ˆë‹¤.

- [ì •ê·œí™” : ë¦¿ì§€(Ridge), ë¼ì˜(Lasso) with R - ë°ì´í„° ë…¸íŠ¸ ğŸ“](https://novicedata.github.io/regularization/L1L2/)
  

**`ì—˜ë¼ìŠ¤í‹± ë„·`**ì€ Ridge regression(ë¦¿ì§€ íšŒê·€, $L_2$)ì™€ LASSO(ë¼ì˜ íšŒê·€, $L_1$)ì„ cobination í•œ ê²ƒì…ë‹ˆë‹¤.

## â—¼ï¸ Elastic nets ì ‘ê·¼

ì—˜ë¼ìŠ¤í‹±ë„·ì˜ solutionì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

$$
\frac1{2n} \sum_{i=1^n}(y_i-\beta_0-\sum_{j=1}^p \beta_j x_{ij})^2 + \lambda((1-\alpha)\frac12 \sum_{j=1}^p \beta_j^2 + \alpha \sum_{j=1}^p \|\beta_j\|)
$$

**`ë¦¿ì§€ì˜ ì œê³±í•­ê³¼ ë¼ì˜ì˜ ì ˆëŒ“ê°’í•­ ëª¨ë‘ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.`** $\lambda$ë¿ ì•„ë‹ˆë¼ $\alpha$ë¼ëŠ” íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

$\alpha$ê°’ìœ¼ë¡œ ë¦¿ì§€ì™€ ë¼ì˜ ì‚¬ì´ì˜ ì •ë„ë¥¼ ì¡°ì •í•´ì¤ë‹ˆë‹¤.

- ë§Œì•½ $\alpha =0$ ì´ë©´, **`ridge solution`**ê³¼ ê°™ì•„ì§‘ë‹ˆë‹¤.
  
- ë§Œì•½ $\alpha =1$ ì´ë©´, **`LASSO`**ì™€ ê°™ì•„ì§‘ë‹ˆë‹¤.
  

## â—¼ï¸ With R

### Auto ë°ì´í„°ë¥¼ ì´ìš©í•œ mpg ì˜ˆì¸¡

```r
library(ISLR)
x = model.matrix(mpg~.,Auto)[,-1]
y = Auto$mpg

# name ì—´ ì œê±°
Auto = Auto[,!(names(Auto) %in% c('name'))]
```

### Train, Test set ë‚˜ëˆ„ê¸° 8:2

```r
train = sample(1:nrow(x), 0.8*nrow(x))

dftrain = Auto[train,]
dftest = Auto[-train,]
```

### Train dataë¥¼ 5-foldë¡œ

```r
library(caret)
library(glmnet)

myfolds = createFolds(dftrain$mpg, k=5, returnTrain=T)

# Train setë¥¼ 5-foldë¡œ 
mycontrol = trainControl(method='cv', number=5,
                         index=myfolds,
                         savePredictions = 'final')
```

### model fitting í•˜ê¸°

```r
# ì•ŒíŒŒì™€ ëŒë‹¤ê°’ì€ defaultê°’ìœ¼ë¡œ ì§€ì •.
fit = train(mpg~., data=dftrain, method='glmnet',
            trControl=mycontrol,
            tuneLength=3, preProcess=c('center', 'scale'))

fit
```

![image](https://github.com/novicedata/scrap-comment/assets/88019539/51dcde05-127b-4a12-8255-4dc6a9f672e8)

fití•œ ê²°ê³¼ë¥¼ ë³´ì‹œë©´ 5-foldì˜ ì•ŒíŒŒ ê°’, ëŒë‹¤ ê°’ ê°ê° ì„¸ê°€ì§€ ì¡°í•©ì¼ë–„ RMSEê°’ì´ ë‚˜ì˜µë‹ˆë‹¤. ìš°ë¦¬ëŠ” ì´ RMSEê°’ì´ ìµœì €ì¸ ê²ƒì„ ë´ì•¼ê² ì£ .

### best parameter í™•ì¸

```r
# best lambda, alpha ê°’
best = fit$bestTune
best 
>> alpha    lambda
8     1 0.1256238
```

ì´ëŠ” 8ë²ˆì§¸ ì¡°í•©ì¸ ì•ŒíŒŒ : 1, ëŒë‹¤ : 0.1256238 ì¼ë•Œ ìµœì €ì˜ RMSEë¥¼ ê°–ëŠ”ë‹¤ëŠ” ì˜ë¯¸ ì…ë‹ˆë‹¤.

### Test setì˜ RMSE í™•ì¸í•˜ê¸°

```r
pred = predict.train(fit, dftest)
mean((dftest$mpg-pred)^2) 
>> 10.18244
```

ìµœì¢… test setì— ì ìš©í•˜ì˜€ì„ ë•ŒëŠ” 10.18244 RMSEê°€ ë‚˜ì˜¤ë„¤ìš”.
